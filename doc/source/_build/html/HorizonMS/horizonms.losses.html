<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>horizonms.losses &mdash; HorizonMS 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=01f34227"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="horizonms.metrics" href="horizonms.metrics.html" />
    <link rel="prev" title="horizonms.engine" href="horizonms.engine.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            HorizonMS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Python API:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="horizonms.html">horizonms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="horizonms.configs.html">horizonms.configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.datasets.html">horizonms.datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.engine.html">horizonms.engine</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">horizonms.losses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.base">horizonms.losses.base</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.base.SoftmaxBaseLoss"><code class="docutils literal notranslate"><span class="pre">SoftmaxBaseLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.base.SigmoidBaseLoss"><code class="docutils literal notranslate"><span class="pre">SigmoidBaseLoss</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.bbox_sigmoid_func">horizonms.losses.bbox_sigmoid_func</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_unary_baseline_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">mil_unary_baseline_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_unary_baseline_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">mil_approx_unary_baseline_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_unary_baseline_pos_generalized_neg_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">mil_unary_baseline_pos_generalized_neg_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_unary_baseline_pos_generalized_neg_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">mil_approx_unary_baseline_pos_generalized_neg_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_unary_parallel_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">mil_unary_parallel_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_unary_parallel_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">mil_approx_unary_parallel_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_polar_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">mil_approx_polar_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_unary_bbox_pos_generalized_neg_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">mil_unary_bbox_pos_generalized_neg_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_unary_bbox_pos_generalized_neg_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">mil_approx_unary_bbox_pos_generalized_neg_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_func.mil_pairwise_loss"><code class="docutils literal notranslate"><span class="pre">mil_pairwise_loss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.bbox_sigmoid_losses">horizonms.losses.bbox_sigmoid_losses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILUnaryBaselineSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">MILUnaryBaselineSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryBaselineSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">MILApproxUnaryBaselineSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILUnaryBaselinePosGeneralizedNegSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">MILUnaryBaselinePosGeneralizedNegSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryBaselinePosGeneralizedNegSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">MILApproxUnaryBaselinePosGeneralizedNegSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILUnaryParallelSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">MILUnaryParallelSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryParallelSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">MILApproxUnaryParallelSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryPolarSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">MILApproxUnaryPolarSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILUnaryBboxPosGeneralizedNegSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">MILUnaryBboxPosGeneralizedNegSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryBboxPosGeneralizedNegSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">MILApproxUnaryBboxPosGeneralizedNegSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.bbox_sigmoid_losses.MILPairwiseLoss"><code class="docutils literal notranslate"><span class="pre">MILPairwiseLoss</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.functional_tensor">horizonms.losses.functional_tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.convert_image_dtype"><code class="docutils literal notranslate"><span class="pre">convert_image_dtype()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.vflip"><code class="docutils literal notranslate"><span class="pre">vflip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.hflip"><code class="docutils literal notranslate"><span class="pre">hflip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.crop"><code class="docutils literal notranslate"><span class="pre">crop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.rgb_to_grayscale"><code class="docutils literal notranslate"><span class="pre">rgb_to_grayscale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.adjust_brightness"><code class="docutils literal notranslate"><span class="pre">adjust_brightness()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.adjust_contrast"><code class="docutils literal notranslate"><span class="pre">adjust_contrast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.adjust_hue"><code class="docutils literal notranslate"><span class="pre">adjust_hue()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.adjust_saturation"><code class="docutils literal notranslate"><span class="pre">adjust_saturation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.adjust_gamma"><code class="docutils literal notranslate"><span class="pre">adjust_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.center_crop"><code class="docutils literal notranslate"><span class="pre">center_crop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.five_crop"><code class="docutils literal notranslate"><span class="pre">five_crop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.ten_crop"><code class="docutils literal notranslate"><span class="pre">ten_crop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.pad"><code class="docutils literal notranslate"><span class="pre">pad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.resize"><code class="docutils literal notranslate"><span class="pre">resize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.affine"><code class="docutils literal notranslate"><span class="pre">affine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.rotate"><code class="docutils literal notranslate"><span class="pre">rotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.perspective"><code class="docutils literal notranslate"><span class="pre">perspective()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.functional_tensor.gaussian_blur"><code class="docutils literal notranslate"><span class="pre">gaussian_blur()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.losses">horizonms.losses.losses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.losses.WeakCrossEntropyLoss"><code class="docutils literal notranslate"><span class="pre">WeakCrossEntropyLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.losses.CDRSmoothL1Loss"><code class="docutils literal notranslate"><span class="pre">CDRSmoothL1Loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.losses.PseudoCrossEntropyLoss"><code class="docutils literal notranslate"><span class="pre">PseudoCrossEntropyLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.losses.PseudoPositiveCrossEntropyLoss"><code class="docutils literal notranslate"><span class="pre">PseudoPositiveCrossEntropyLoss</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.losses_func">horizonms.losses.losses_func</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.losses_func.smooth_l1_loss"><code class="docutils literal notranslate"><span class="pre">smooth_l1_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.losses_func.weak_cross_entropy"><code class="docutils literal notranslate"><span class="pre">weak_cross_entropy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.losses_func.size_constraint_loss"><code class="docutils literal notranslate"><span class="pre">size_constraint_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.losses_func.weak_bce_sigmoid_loss"><code class="docutils literal notranslate"><span class="pre">weak_bce_sigmoid_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.losses_func.bbox_overlaps"><code class="docutils literal notranslate"><span class="pre">bbox_overlaps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.parallel_transform">horizonms.losses.parallel_transform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.parallel_transform.rotate"><code class="docutils literal notranslate"><span class="pre">rotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.parallel_transform.parallel_transform"><code class="docutils literal notranslate"><span class="pre">parallel_transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.polar_transform">horizonms.losses.polar_transform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.polar_transform.polar_transform"><code class="docutils literal notranslate"><span class="pre">polar_transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.regression_losses">horizonms.losses.regression_losses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.regression_losses.SmoothL1Loss"><code class="docutils literal notranslate"><span class="pre">SmoothL1Loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.regression_losses.RegressionIouLoss"><code class="docutils literal notranslate"><span class="pre">RegressionIouLoss</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.sigmoid_losses">horizonms.losses.sigmoid_losses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.sigmoid_losses.SigmoidCrossEntropyLoss"><code class="docutils literal notranslate"><span class="pre">SigmoidCrossEntropyLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.sigmoid_losses.SigmoidFocalLoss"><code class="docutils literal notranslate"><span class="pre">SigmoidFocalLoss</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.sigmoid_softmax_losses">horizonms.losses.sigmoid_softmax_losses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.sigmoid_softmax_losses.DiceLoss"><code class="docutils literal notranslate"><span class="pre">DiceLoss</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-horizonms.losses.softmax_losses">horizonms.losses.softmax_losses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.softmax_losses.SoftmaxCohenKappaLoss"><code class="docutils literal notranslate"><span class="pre">SoftmaxCohenKappaLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.softmax_losses.SoftmaxFocalLoss"><code class="docutils literal notranslate"><span class="pre">SoftmaxFocalLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.softmax_losses.SoftmaxMixFocalLoss"><code class="docutils literal notranslate"><span class="pre">SoftmaxMixFocalLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#horizonms.losses.softmax_losses.SoftmaxCrossEntropyLoss"><code class="docutils literal notranslate"><span class="pre">SoftmaxCrossEntropyLoss</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.metrics.html">horizonms.metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.models.html">horizonms.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.samplers.html">horizonms.samplers</a></li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.transforms.html">horizonms.transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.utils.html">horizonms.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.html#module-horizonms.builder">horizonms.builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.html#module-horizonms.testing_utils">horizonms.testing_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="horizonms.html#horizonms-training-utils">horizonms.training_utils</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HorizonMS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="horizonms.html">horizonms</a></li>
      <li class="breadcrumb-item active">horizonms.losses</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/HorizonMS/horizonms.losses.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="horizonms-losses">
<h1>horizonms.losses<a class="headerlink" href="#horizonms-losses" title="Link to this heading"></a></h1>
<section id="module-horizonms.losses.base">
<span id="horizonms-losses-base"></span><h2>horizonms.losses.base<a class="headerlink" href="#module-horizonms.losses.base" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.base.SoftmaxBaseLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.base.</span></span><span class="sig-name descname"><span class="pre">SoftmaxBaseLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">missing_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/base.html#SoftmaxBaseLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.base.SoftmaxBaseLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p class="linemarker linemarker-1">Base class for softmax loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>missing_values</strong> (<em>bool</em>) – whether to handle missing values.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of loss.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.base.SoftmaxBaseLoss.preprocess">
<span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/base.html#SoftmaxBaseLoss.preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.base.SoftmaxBaseLoss.preprocess" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.base.SoftmaxBaseLoss.remove_missing_values">
<span class="sig-name descname"><span class="pre">remove_missing_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/base.html#SoftmaxBaseLoss.remove_missing_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.base.SoftmaxBaseLoss.remove_missing_values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.base.SoftmaxBaseLoss.calculate_loss">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/base.html#SoftmaxBaseLoss.calculate_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.base.SoftmaxBaseLoss.calculate_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.base.SigmoidBaseLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.base.</span></span><span class="sig-name descname"><span class="pre">SigmoidBaseLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">missing_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/base.html#SigmoidBaseLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.base.SigmoidBaseLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p class="linemarker linemarker-1">Base class for sigmoid loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>missing_values</strong> (<em>bool</em>) – whether to handle missing values.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of loss.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.base.SigmoidBaseLoss.preprocess">
<span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/base.html#SigmoidBaseLoss.preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.base.SigmoidBaseLoss.preprocess" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.base.SigmoidBaseLoss.detect_existing_values">
<span class="sig-name descname"><span class="pre">detect_existing_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/base.html#SigmoidBaseLoss.detect_existing_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.base.SigmoidBaseLoss.detect_existing_values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.base.SigmoidBaseLoss.calculate_loss">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/base.html#SigmoidBaseLoss.calculate_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.base.SigmoidBaseLoss.calculate_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-horizonms.losses.bbox_sigmoid_func">
<span id="horizonms-losses-bbox-sigmoid-func"></span><h2>horizonms.losses.bbox_sigmoid_func<a class="headerlink" href="#module-horizonms.losses.bbox_sigmoid_func" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_unary_baseline_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_unary_baseline_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes_xxyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ce_all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_unary_baseline_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_unary_baseline_sigmoid_loss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Compute the mil baseline unary loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
<li><p><strong>gt_boxes_xxyy</strong> – Tensor of boxes with (N, 6), where N is the number of bouding boxes in the batch,
the 6 elements of each row are [nb_img, class, x1, y1, x2, y2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>losses with shape (C,) for each category</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-11">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_approx_unary_baseline_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_approx_unary_baseline_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes_xxyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ce_all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_approx_unary_baseline_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_unary_baseline_sigmoid_loss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Compute the mil baseline unary loss while applying smooth maximum function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
<li><p><strong>gt_boxes_xxyy</strong> – Tensor of boxes with (N, 6), where N is the number of bouding boxes in the batch,
the 6 elements of each row are [nb_img, class, x1, y1, x2, y2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>losses with shape (C,) for each category</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-11">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_unary_baseline_pos_generalized_neg_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_unary_baseline_pos_generalized_neg_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes_xxyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ce_all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_unary_baseline_pos_generalized_neg_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_unary_baseline_pos_generalized_neg_sigmoid_loss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Compute the mil baseline unary loss, in which the generalized negative bag is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
<li><p><strong>gt_boxes_xxyy</strong> – Tensor of boxes with (N, 6), where N is the number of bouding boxes in the batch,
the 6 elements of each row are [nb_img, class, x1, y1, x2, y2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>losses with shape (C,) for each category</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-11">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_approx_unary_baseline_pos_generalized_neg_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_approx_unary_baseline_pos_generalized_neg_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes_xxyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ce_all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_approx_unary_baseline_pos_generalized_neg_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_unary_baseline_pos_generalized_neg_sigmoid_loss" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Compute the mil baseline unary loss while applying smooth maximum function,</dt><dd><p class="linemarker linemarker-2">in which the generalized negative bag is used.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
<li><p><strong>gt_boxes_xxyy</strong> – Tensor of boxes with (N, 6), where N is the number of bouding boxes in the batch,
the 6 elements of each row are [nb_img, class, x1, y1, x2, y2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>losses with shape (C,) for each category</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-12">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_unary_parallel_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_unary_parallel_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes_cr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ce_all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(60,</span> <span class="pre">-61,</span> <span class="pre">30)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0,</span> <span class="pre">'sampling_prob':</span> <span class="pre">1.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_unary_parallel_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_unary_parallel_sigmoid_loss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Compute the mil generalized unary loss while no smooth maximum function is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
<li><p><strong>gt_boxes_cr</strong> – Tensor of boxes with (N, 5), where N is the number of bouding boxes in the batch,
the 5 elements of each row are [nb_img, class, center_x, center_r, radius]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>losses with shape (C,) for each category</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-11">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_approx_unary_parallel_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_approx_unary_parallel_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes_cr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'focal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(60,</span> <span class="pre">-61,</span> <span class="pre">30)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_approx_unary_parallel_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_unary_parallel_sigmoid_loss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Compute the mil generalized unary loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
<li><p><strong>gt_boxes_cr</strong> – Tensor of boxes with (N, 5), where N is the number of bouding boxes in the batch,
the 5 elements of each row are [nb_img, class, center_x, center_r, radius]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>losses with shape (C,) for each category</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-11">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_approx_polar_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_approx_polar_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes_cr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'focal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fixed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'output_shape':</span> <span class="pre">[90,</span> <span class="pre">30],</span> <span class="pre">'scaling':</span> <span class="pre">'linear'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_approx_polar_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_polar_sigmoid_loss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Compute the mil unary loss based on polar transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
<li><p><strong>gt_boxes_cr</strong> – Tensor of boxes with (N, 5), where N is the number of bouding boxes in the batch,
the 5 elements of each row are [nb_img, class, center_x, center_r, radius]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>losses with shape (C,) for each category</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-11">Wang, J. and Xia, B., 2022. Polar Transformation Based Multiple Instance
Learning Assisting Weakly Supervised Image Segmentation With Loose
Bounding Box Annotations. arXiv preprint arXiv:2203.06000.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_unary_bbox_pos_generalized_neg_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_unary_bbox_pos_generalized_neg_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes_xxyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'focal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_unary_bbox_pos_generalized_neg_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_unary_bbox_pos_generalized_neg_sigmoid_loss" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Compute the mil unary loss. A positive bag is defined as all pixels in a bounding box;</dt><dd><p class="linemarker linemarker-2">generalized negative bag is used.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
<li><p><strong>gt_boxes_xxyy</strong> – Tensor of boxes with (N, 6), where N is the number of bouding boxes in the batch,
the 6 elements of each row are [nb_img, class, x1, y1, x2, y2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>losses with shape (C,) for each category</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-12">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_approx_unary_bbox_pos_generalized_neg_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_approx_unary_bbox_pos_generalized_neg_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes_xxyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'focal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_approx_unary_bbox_pos_generalized_neg_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_approx_unary_bbox_pos_generalized_neg_sigmoid_loss" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Compute the mil unary loss. A positive bag is defined as all pixels in a bounding box;</dt><dd><p class="linemarker linemarker-2">generalized negative bag is used.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
<li><p><strong>gt_boxes_xxyy</strong> – Tensor of boxes with (N, 6), where N is the number of bouding boxes in the batch,
the 6 elements of each row are [nb_img, class, x1, y1, x2, y2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>losses with shape (C,) for each category</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-12">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_func.mil_pairwise_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_func.</span></span><span class="sig-name descname"><span class="pre">mil_pairwise_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_func.html#mil_pairwise_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_func.mil_pairwise_loss" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Compute the pair-wise loss.</dt><dd><p class="linemarker linemarker-2">As defined in Weakly Supervised Instance Segmentation using the Bounding Box Tightness Prior</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ypred</strong> – Tensor of predicted data from the network with shape (B, C, W, H).</p></li>
<li><p><strong>mask</strong> – Tensor of mask with shape (B, C, W, H), bounding box regions with value 1 and 0 otherwise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pair-wise loss for each category (C,)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-horizonms.losses.bbox_sigmoid_losses">
<span id="horizonms-losses-bbox-sigmoid-losses"></span><h2>horizonms.losses.bbox_sigmoid_losses<a class="headerlink" href="#module-horizonms.losses.bbox_sigmoid_losses" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILUnaryBaselineSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILUnaryBaselineSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ce_all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILUnaryBaselineSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILUnaryBaselineSigmoidLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="linemarker linemarker-1">Compute the mil baseline unary loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_mode</strong> (<em>str</em>) – type of loss. It is <cite>‘ce_all’</cite> for cross entropy loss for all samples,
<cite>‘ce_balance’</cite> for cross entropy loss for positive and negative classes , or <cite>‘focal’</cite> for focal loss.</p></li>
<li><p><strong>focal_params</strong> (<em>Dict</em>) – parameters for focal loss.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of the loss calcualtion.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-12">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryBaselineSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILApproxUnaryBaselineSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ce_all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILApproxUnaryBaselineSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryBaselineSigmoidLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="linemarker linemarker-1">Compute the mil baseline unary loss while applying smooth maximum function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_mode</strong> (<em>str</em>) – type of loss. It is <cite>‘ce_all’</cite> for cross entropy loss for all samples,
<cite>‘ce_balance’</cite> for cross entropy loss for positive and negative classes , or <cite>‘focal’</cite> for focal loss.</p></li>
<li><p><strong>approx_method</strong> (<em>str</em>) – name of smooth maximum function. It is <cite>‘softmax’</cite> or <cite>‘quasimax’</cite>.</p></li>
<li><p><strong>approx_alpha</strong> (<em>float</em>) – parameter of smooth maximum function.</p></li>
<li><p><strong>focal_params</strong> (<em>Dict</em>) – parameters for focal loss.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of the loss calcualtion.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-16">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILUnaryBaselinePosGeneralizedNegSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILUnaryBaselinePosGeneralizedNegSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ce_all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILUnaryBaselinePosGeneralizedNegSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILUnaryBaselinePosGeneralizedNegSigmoidLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="linemarker linemarker-1">Compute the mil baseline unary loss, in which the generalized negative bag is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_mode</strong> (<em>str</em>) – type of loss. It is <cite>‘ce_all’</cite> for cross entropy loss for all samples,
<cite>‘ce_balance’</cite> for cross entropy loss for positive and negative classes , or <cite>‘focal’</cite> for focal loss.</p></li>
<li><p><strong>focal_params</strong> (<em>Dict</em>) – parameters for focal loss.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of the loss calcualtion.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-12">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryBaselinePosGeneralizedNegSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILApproxUnaryBaselinePosGeneralizedNegSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ce_all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILApproxUnaryBaselinePosGeneralizedNegSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryBaselinePosGeneralizedNegSigmoidLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Compute the mil baseline unary loss while applying smooth maximum function,</dt><dd><p class="linemarker linemarker-2">in which the generalized negative bag is used.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_mode</strong> (<em>str</em>) – type of loss. It is <cite>‘ce_all’</cite> for cross entropy loss for all samples,
<cite>‘ce_balance’</cite> for cross entropy loss for positive and negative classes , or <cite>‘focal’</cite> for focal loss.</p></li>
<li><p><strong>approx_method</strong> (<em>str</em>) – name of smooth maximum function. It is <cite>‘softmax’</cite> or <cite>‘quasimax’</cite>.</p></li>
<li><p><strong>approx_alpha</strong> (<em>float</em>) – parameter of smooth maximum function.</p></li>
<li><p><strong>focal_params</strong> (<em>Dict</em>) – parameters for focal loss.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of the loss calcualtion.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-17">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILUnaryParallelSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILUnaryParallelSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-60,</span> <span class="pre">61,</span> <span class="pre">30)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILUnaryParallelSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILUnaryParallelSigmoidLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="linemarker linemarker-1">Compute the mil generalized unary loss while no smooth maximum function is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_mode</strong> (<em>str</em>) – type of loss. It is <cite>‘ce_all’</cite> for cross entropy loss for all samples,
<cite>‘ce_balance’</cite> for cross entropy loss for positive and negative classes , or <cite>‘focal’</cite> for focal loss.</p></li>
<li><p><strong>angle_params</strong> (<em>tuple</em>) – degree of parallel crossing lines in the format of (start, stop, step).</p></li>
<li><p><strong>focal_params</strong> (<em>Dict</em>) – parameters for focal loss.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of the loss calcualtion.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-14">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryParallelSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILApproxUnaryParallelSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'focal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-60,</span> <span class="pre">61,</span> <span class="pre">30)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILApproxUnaryParallelSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryParallelSigmoidLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="linemarker linemarker-1">Compute the mil generalized unary loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_mode</strong> (<em>str</em>) – type of loss. It is <cite>‘ce_all’</cite> for cross entropy loss for all samples,
<cite>‘ce_balance’</cite> for cross entropy loss for positive and negative classes , or <cite>‘focal’</cite> for focal loss.</p></li>
<li><p><strong>angle_params</strong> (<em>tuple</em>) – degree of parallel crossing lines in the format of (start, stop, step).</p></li>
<li><p><strong>approx_method</strong> (<em>str</em>) – name of smooth maximum function. It is <cite>‘softmax’</cite> or <cite>‘quasimax’</cite>.</p></li>
<li><p><strong>approx_alpha</strong> (<em>float</em>) – parameter of smooth maximum function.</p></li>
<li><p><strong>focal_params</strong> (<em>Dict</em>) – parameters for focal loss.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of the loss calcualtion.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-18">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryPolarSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILApproxUnaryPolarSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'focal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fixed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'output_shape':</span> <span class="pre">[90,</span> <span class="pre">30],</span> <span class="pre">'scaling':</span> <span class="pre">'linear'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILApproxUnaryPolarSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryPolarSigmoidLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="linemarker linemarker-1">Compute the mil unary loss based on polar transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_mode</strong> (<em>str</em>) – type of loss. It is <cite>‘ce_all’</cite> for cross entropy loss for all samples,
<cite>‘ce_balance’</cite> for cross entropy loss for positive and negative classes , or <cite>‘focal’</cite> for focal loss.</p></li>
<li><p><strong>weight_min</strong> (<em>float</em>) – minimum weight of the samples in a polar line.</p></li>
<li><p><strong>center_mode</strong> (<em>str</em>) – center of the polar transformation. It is <cite>‘fixed’</cite> or <cite>‘estimated’</cite>.</p></li>
<li><p><strong>approx_method</strong> (<em>str</em>) – name of smooth maximum function. It is <cite>‘softmax’</cite> or <cite>‘quasimax’</cite>.</p></li>
<li><p><strong>approx_alpha</strong> (<em>float</em>) – parameter of smooth maximum function.</p></li>
<li><p><strong>pt_params</strong> (<em>Dict</em>) – parameters of polar transformation. Keys in the dictionary are <cite>‘output_shape’</cite> and <cite>‘scaling’</cite>.</p></li>
<li><p><strong>focal_params</strong> (<em>Dict</em>) – parameters for focal loss.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of the loss calcualtion.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-22">Wang, J. and Xia, B., 2022. Polar Transformation Based Multiple Instance
Learning Assisting Weakly Supervised Image Segmentation With Loose
Bounding Box Annotations. arXiv preprint arXiv:2203.06000.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILUnaryBboxPosGeneralizedNegSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILUnaryBboxPosGeneralizedNegSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'focal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILUnaryBboxPosGeneralizedNegSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILUnaryBboxPosGeneralizedNegSigmoidLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Compute the mil unary loss. A positive bag is defined as all pixels in a bounding box;</dt><dd><p class="linemarker linemarker-2">generalized negative bag is used.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_mode</strong> (<em>str</em>) – type of loss. It is <cite>‘ce_all’</cite> for cross entropy loss for all samples,
<cite>‘ce_balance’</cite> for cross entropy loss for positive and negative classes , or <cite>‘focal’</cite> for focal loss.</p></li>
<li><p><strong>focal_params</strong> (<em>Dict</em>) – parameters for focal loss.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of the loss calcualtion.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-13">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryBboxPosGeneralizedNegSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILApproxUnaryBboxPosGeneralizedNegSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'focal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILApproxUnaryBboxPosGeneralizedNegSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILApproxUnaryBboxPosGeneralizedNegSigmoidLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Compute the mil unary loss. A positive bag is defined as all pixels in a bounding box;</dt><dd><p class="linemarker linemarker-2">generalized negative bag is used.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_mode</strong> (<em>str</em>) – type of loss. It is <cite>‘ce_all’</cite> for cross entropy loss for all samples,
<cite>‘ce_balance’</cite> for cross entropy loss for positive and negative classes , or <cite>‘focal’</cite> for focal loss.</p></li>
<li><p><strong>approx_method</strong> (<em>str</em>) – name of smooth maximum function. It is <cite>‘softmax’</cite> or <cite>‘quasimax’</cite>.</p></li>
<li><p><strong>approx_alpha</strong> (<em>float</em>) – parameter of smooth maximum function.</p></li>
<li><p><strong>focal_params</strong> (<em>Dict</em>) – parameters for focal loss.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of the loss calcualtion.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p class="linemarker linemarker-17">Wang, J. and Xia, B., 2021, September. Bounding box tightness prior
for weakly supervised image segmentation. In International Conference on
Medical Image Computing and Computer-Assisted Intervention (pp. 526-536).
Springer, Cham.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.bbox_sigmoid_losses.MILPairwiseLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.bbox_sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">MILPairwiseLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/bbox_sigmoid_losses.html#MILPairwiseLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.bbox_sigmoid_losses.MILPairwiseLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Compute the pair-wise loss.</dt><dd><p class="linemarker linemarker-2">As defined in Weakly Supervised Instance Segmentation using the Bounding Box Tightness Prior.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>softmax</strong> (<em>bool</em>) – If True, the network outputs softmax probability.</p></li>
<li><p><strong>exp_coef</strong> (<em>float</em>) – coefficient of exponential function applied to network output&gt; It should be positive.
-1 denotes coefficient of exponential function is not applied.  Default: -1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-horizonms.losses.functional_tensor">
<span id="horizonms-losses-functional-tensor"></span><h2>horizonms.losses.functional_tensor<a class="headerlink" href="#module-horizonms.losses.functional_tensor" title="Link to this heading"></a></h2>
<p class="linemarker linemarker-1">Codes are borrowed from torchvision</p>
<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.convert_image_dtype">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">convert_image_dtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#convert_image_dtype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.convert_image_dtype" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Convert a tensor image to the given <code class="docutils literal notranslate"><span class="pre">dtype</span></code> and scale the values accordingly</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – Image to be converted</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – Desired data type of the output</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(torch.Tensor)</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="linemarker linemarker-18">When converting from a smaller to a larger integer <code class="docutils literal notranslate"><span class="pre">dtype</span></code> the maximum values are <strong>not</strong> mapped exactly.
If converted back and forth, this mismatch has no effect.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – When trying to cast <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.float32</span></code> to <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.int32</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.int64</span></code> as
    well as for trying to cast <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.float64</span></code> to <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.int64</span></code>. These conversions might lead to
    overflow errors since the floating point <code class="docutils literal notranslate"><span class="pre">dtype</span></code> cannot store consecutive integers over the whole range
    of the integer <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.vflip">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">vflip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#vflip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.vflip" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Vertically flip the given the Image Tensor.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>Tensor</em>) – Image Tensor to be flipped in the form […, C, H, W].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Vertically flipped image Tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.hflip">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">hflip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#hflip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.hflip" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Horizontally flip the given the Image Tensor.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>Tensor</em>) – Image Tensor to be flipped in the form […, C, H, W].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Horizontally flipped image Tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.crop">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.crop" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Crop the given Image Tensor.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be cropped in the form […, H, W]. (0,0) denotes the top left corner of the image.</p></li>
<li><p><strong>top</strong> (<em>int</em>) – Vertical component of the top left corner of the crop box.</p></li>
<li><p><strong>left</strong> (<em>int</em>) – Horizontal component of the top left corner of the crop box.</p></li>
<li><p><strong>height</strong> (<em>int</em>) – Height of the crop box.</p></li>
<li><p><strong>width</strong> (<em>int</em>) – Width of the crop box.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cropped image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.rgb_to_grayscale">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">rgb_to_grayscale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_output_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#rgb_to_grayscale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.rgb_to_grayscale" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Convert the given RGB Image Tensor to Grayscale.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<p class="linemarker linemarker-8">For RGB to Grayscale conversion, ITU-R 601-2 luma transform is performed which
is L = R * 0.2989 + G * 0.5870 + B * 0.1140</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be converted to Grayscale in the form [C, H, W].</p></li>
<li><p><strong>num_output_channels</strong> (<em>int</em>) – number of channels of the output image. Value can be 1 or 3. Default, 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>Grayscale version of the image.</dt><dd><p class="linemarker linemarker-19">if num_output_channels = 1 : returned image is single channel</p>
<p class="linemarker linemarker-21">if num_output_channels = 3 : returned image is 3 channel with r = g = b</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.adjust_brightness">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">adjust_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#adjust_brightness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.adjust_brightness" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Adjust brightness of an RGB image.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be adjusted.</p></li>
<li><p><strong>brightness_factor</strong> (<em>float</em>) – How much to adjust the brightness. Can be
any non negative number. 0 gives a black image, 1 gives the
original image while 2 increases the brightness by a factor of 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Brightness adjusted image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.adjust_contrast">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">adjust_contrast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrast_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#adjust_contrast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.adjust_contrast" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Adjust contrast of an RGB image.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be adjusted.</p></li>
<li><p><strong>contrast_factor</strong> (<em>float</em>) – How much to adjust the contrast. Can be any
non negative number. 0 gives a solid gray image, 1 gives the
original image while 2 increases the contrast by a factor of 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contrast adjusted image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.adjust_hue">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">adjust_hue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hue_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#adjust_hue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.adjust_hue" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Adjust hue of an image.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<p class="linemarker linemarker-8">The image hue is adjusted by converting the image to HSV and
cyclically shifting the intensities in the hue channel (H).
The image is then converted back to original image mode.</p>
<p class="linemarker linemarker-12"><cite>hue_factor</cite> is the amount of shift in H channel and must be in the
interval <cite>[-0.5, 0.5]</cite>.</p>
<p class="linemarker linemarker-15">See <a class="reference external" href="https://en.wikipedia.org/wiki/Hue">Hue</a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be adjusted. Image type is either uint8 or float.</p></li>
<li><p><strong>hue_factor</strong> (<em>float</em>) – How much to shift the hue channel. Should be in
[-0.5, 0.5]. 0.5 and -0.5 give complete reversal of hue channel in
HSV space in positive and negative direction respectively.
0 means no shift. Therefore, both -0.5 and 0.5 will give an image
with complementary colors while 0 gives the original image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hue adjusted image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.adjust_saturation">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">adjust_saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saturation_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#adjust_saturation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.adjust_saturation" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Adjust color saturation of an RGB image.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be adjusted.</p></li>
<li><p><strong>saturation_factor</strong> (<em>float</em>) – How much to adjust the saturation. Can be any
non negative number. 0 gives a black and white image, 1 gives the
original image while 2 enhances the saturation by a factor of 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Saturation adjusted image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.adjust_gamma">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">adjust_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#adjust_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.adjust_gamma" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Adjust gamma of an RGB image.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<p class="linemarker linemarker-8">Also known as Power Law Transform. Intensities in RGB mode are adjusted
based on the following equation:</p>
<div class="math notranslate nohighlight">
\[`I_{\text{out}} = 255 \times \text{gain} \times \left(\frac{I_{\text{in}}}{255}\right)^{\gamma}`\]</div>
<p class="linemarker linemarker-14">See <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_correction">Gamma Correction</a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Tensor of RBG values to be adjusted.</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – Non negative real number, same as <span class="math notranslate nohighlight">\(\gamma\)</span> in the equation.
gamma larger than 1 make the shadows darker,
while gamma smaller than 1 make dark regions lighter.</p></li>
<li><p><strong>gain</strong> (<em>float</em>) – The constant multiplier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.center_crop">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">center_crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#center_crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.center_crop" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">DEPRECATED. Crop the Image Tensor and resize it to desired size.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-10">This method is deprecated and will be removed in future releases.
Please, use <code class="docutils literal notranslate"><span class="pre">F.center_crop</span></code> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be cropped.</p></li>
<li><p><strong>output_size</strong> (<em>sequence</em><em> or </em><em>int</em>) – (height, width) of the crop box. If int,
it is used for both directions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cropped image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.five_crop">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">five_crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#five_crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.five_crop" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">DEPRECATED. Crop the given Image Tensor into four corners and the central crop.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-10">This method is deprecated and will be removed in future releases.
Please, use <code class="docutils literal notranslate"><span class="pre">F.five_crop</span></code> instead.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="linemarker linemarker-15">This transform returns a List of Tensors and there may be a
mismatch in the number of inputs and targets your <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> returns.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be cropped.</p></li>
<li><p><strong>size</strong> (<em>sequence</em><em> or </em><em>int</em>) – Desired output size of the crop. If size is an
int instead of sequence like (h, w), a square crop (size, size) is
made.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>List (tl, tr, bl, br, center)</dt><dd><p class="linemarker linemarker-28">Corresponding top left, top right, bottom left, bottom right and center crop.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.ten_crop">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">ten_crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_flip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#ten_crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.ten_crop" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>DEPRECATED. Crop the given Image Tensor into four corners and the central crop plus the</dt><dd><p class="linemarker linemarker-2">flipped version of these (horizontal flipping is used by default).</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-6">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-11">This method is deprecated and will be removed in future releases.
Please, use <code class="docutils literal notranslate"><span class="pre">F.ten_crop</span></code> instead.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="linemarker linemarker-16">This transform returns a List of images and there may be a
mismatch in the number of inputs and targets your <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> returns.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be cropped.</p></li>
<li><p><strong>size</strong> (<em>sequence</em><em> or </em><em>int</em>) – Desired output size of the crop. If size is an
int instead of sequence like (h, w), a square crop (size, size) is
made.</p></li>
<li><p><strong>vertical_flip</strong> (<em>bool</em>) – Use vertical flipping instead of horizontal</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>List (tl, tr, bl, br, center, tl_flip, tr_flip, bl_flip, br_flip, center_flip)</dt><dd><p class="linemarker linemarker-31">Corresponding top left, top right, bottom left, bottom right and center crop
and same for the flipped image’s tensor.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.pad">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'constant'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.pad" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Pad the given Tensor Image on all sides with specified padding mode and fill value.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be padded.</p></li>
<li><p><strong>padding</strong> (<em>int</em><em> or </em><em>tuple</em><em> or </em><em>list</em>) – Padding on each border. If a single int is provided this
is used to pad all borders. If a tuple or list of length 2 is provided this is the padding
on left/right and top/bottom respectively. If a tuple or list of length 4 is provided
this is the padding for the left, top, right and bottom borders
respectively. In torchscript mode padding as single int is not supported, use a tuple or
list of length 1: <code class="docutils literal notranslate"><span class="pre">[padding,</span> <span class="pre">]</span></code>.</p></li>
<li><p><strong>fill</strong> (<em>int</em>) – Pixel fill value for constant fill. Default is 0.
This value is only used when the padding_mode is constant</p></li>
<li><p><strong>padding_mode</strong> (<em>str</em>) – <p class="linemarker linemarker-20">Type of padding. Should be: constant, edge or reflect. Default is constant.
Mode symmetric is not yet supported for Tensor inputs.</p>
<ul>
<li><p class="linemarker linemarker-23">constant: pads with a constant value, this value is specified with fill</p></li>
<li><p class="linemarker linemarker-25">edge: pads with the last value on the edge of the image</p></li>
<li><p class="linemarker linemarker-27">reflect: pads with reflection of image (without repeating the last value on the edge)</p>
<blockquote>
<div><p class="linemarker linemarker-29">padding [1, 2, 3, 4] with 2 elements on both sides in reflect mode
will result in [3, 2, 1, 2, 3, 4, 3, 2]</p>
</div></blockquote>
</li>
<li><p class="linemarker linemarker-32">symmetric: pads with reflection of image (repeating the last value on the edge)</p>
<blockquote>
<div><p class="linemarker linemarker-34">padding [1, 2, 3, 4] with 2 elements on both sides in symmetric mode
will result in [2, 1, 1, 2, 3, 4, 4, 3]</p>
</div></blockquote>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Padded image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.resize">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.resize" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Resize the input Tensor to the given size.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be resized.</p></li>
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> or </em><em>list</em>) – Desired output size. If size is a sequence like
(h, w), the output size will be matched to this. If size is an int,
the smaller edge of the image will be matched to this number maintaining
the aspect ratio. i.e, if height &gt; width, then image will be rescaled to
<span class="math notranslate nohighlight">\(\left(\text{size} \times \frac{\text{height}}{\text{width}}, \text{size}\right)\)</span>.
In torchscript mode padding as a single int is not supported, use a tuple or
list of length 1: <code class="docutils literal notranslate"><span class="pre">[size,</span> <span class="pre">]</span></code>.</p></li>
<li><p><strong>interpolation</strong> (<em>int</em><em>, </em><em>optional</em>) – Desired interpolation. Default is bilinear (=2). Other supported values:
nearest(=0) and bicubic(=3).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resized image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.affine">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillcolor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.affine" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Apply affine transformation on the Tensor image keeping image center invariant.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – image to be rotated.</p></li>
<li><p><strong>matrix</strong> (<em>list</em><em> of </em><em>floats</em>) – list of 6 float values representing inverse matrix for affine transformation.</p></li>
<li><p><strong>resample</strong> (<em>int</em><em>, </em><em>optional</em>) – An optional resampling filter. Default is nearest (=0). Other supported values:
bilinear(=2).</p></li>
<li><p><strong>fillcolor</strong> (<em>int</em><em>, </em><em>optional</em>) – this option is not supported for Tensor input. Fill value for the area outside the
transform in the output image is always 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.rotate">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#rotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.rotate" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Rotate the Tensor image by angle.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – image to be rotated.</p></li>
<li><p><strong>matrix</strong> (<em>list</em><em> of </em><em>floats</em>) – list of 6 float values representing inverse matrix for rotation transformation.
Translation part (<code class="docutils literal notranslate"><span class="pre">matrix[2]</span></code> and <code class="docutils literal notranslate"><span class="pre">matrix[5]</span></code>) should be in pixel coordinates.</p></li>
<li><p><strong>resample</strong> (<em>int</em><em>, </em><em>optional</em>) – An optional resampling filter. Default is nearest (=0). Other supported values:
bilinear(=2).</p></li>
<li><p><strong>expand</strong> (<em>bool</em><em>, </em><em>optional</em>) – Optional expansion flag.
If true, expands the output image to make it large enough to hold the entire rotated image.
If false or omitted, make the output image the same size as the input image.
Note that the expand flag assumes rotation around the center and no translation.</p></li>
<li><p><strong>fill</strong> (<em>n-tuple</em><em> or </em><em>int</em><em> or </em><em>float</em>) – this option is not supported for Tensor input.
Fill value for the area outside the transform in the output image is always 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rotated image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.perspective">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">perspective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perspective_coeffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#perspective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.perspective" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Perform perspective transform of the given Tensor image.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be transformed.</p></li>
<li><p><strong>perspective_coeffs</strong> (<em>list</em><em> of </em><em>float</em>) – perspective transformation coefficients.</p></li>
<li><p><strong>interpolation</strong> (<em>int</em>) – Interpolation type. Default, <code class="docutils literal notranslate"><span class="pre">PIL.Image.BILINEAR</span></code>.</p></li>
<li><p><strong>fill</strong> (<em>n-tuple</em><em> or </em><em>int</em><em> or </em><em>float</em>) – this option is not supported for Tensor input. Fill value for the area
outside the transform in the output image is always 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>transformed image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.functional_tensor.gaussian_blur">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.functional_tensor.</span></span><span class="sig-name descname"><span class="pre">gaussian_blur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/functional_tensor.html#gaussian_blur"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.functional_tensor.gaussian_blur" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">PRIVATE METHOD. Performs Gaussian blurring on the img by given kernel.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p class="linemarker linemarker-5">Module <code class="docutils literal notranslate"><span class="pre">transforms.functional_tensor</span></code> is private and should not be used in user application.
Please, consider instead using methods from <cite>transforms.functional</cite> module.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – Image to be blurred</p></li>
<li><p><strong>kernel_size</strong> (<em>sequence</em><em> of </em><em>int</em><em> or </em><em>int</em>) – Kernel size of the Gaussian kernel <code class="docutils literal notranslate"><span class="pre">(kx,</span> <span class="pre">ky)</span></code>.</p></li>
<li><p><strong>sigma</strong> (<em>sequence</em><em> of </em><em>float</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – Standard deviation of the Gaussian kernel <code class="docutils literal notranslate"><span class="pre">(sx,</span> <span class="pre">sy)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An image that is blurred using gaussian kernel of given parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-horizonms.losses.losses">
<span id="horizonms-losses-losses"></span><h2>horizonms.losses.losses<a class="headerlink" href="#module-horizonms.losses.losses" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.losses.WeakCrossEntropyLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.losses.</span></span><span class="sig-name descname"><span class="pre">WeakCrossEntropyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toppk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/losses.html#WeakCrossEntropyLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.losses.WeakCrossEntropyLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.losses.CDRSmoothL1Loss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.losses.</span></span><span class="sig-name descname"><span class="pre">CDRSmoothL1Loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calculate_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/losses.html#CDRSmoothL1Loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.losses.CDRSmoothL1Loss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.losses.PseudoCrossEntropyLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.losses.</span></span><span class="sig-name descname"><span class="pre">PseudoCrossEntropyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/losses.html#PseudoCrossEntropyLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.losses.PseudoCrossEntropyLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.losses.PseudoPositiveCrossEntropyLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.losses.</span></span><span class="sig-name descname"><span class="pre">PseudoPositiveCrossEntropyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">soft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/losses.html#PseudoPositiveCrossEntropyLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.losses.PseudoPositiveCrossEntropyLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

</section>
<section id="module-horizonms.losses.losses_func">
<span id="horizonms-losses-losses-func"></span><h2>horizonms.losses.losses_func<a class="headerlink" href="#module-horizonms.losses.losses_func" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.losses_func.smooth_l1_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.losses_func.</span></span><span class="sig-name descname"><span class="pre">smooth_l1_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_average</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/losses_func.html#smooth_l1_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.losses_func.smooth_l1_loss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Compute the smooth L1 loss of y_pred w.r.t. y_true.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> – Tensor from the generator of shape (N, 4).</p></li>
<li><p><strong>y_pred</strong> – Tensor from the network of shape (N, 4).</p></li>
<li><p><strong>sigma</strong> – This argument defines the point where the loss changes from L2 to L1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The smooth L1 loss of y_pred w.r.t. y_true.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.losses_func.weak_cross_entropy">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.losses_func.</span></span><span class="sig-name descname"><span class="pre">weak_cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toppk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.25,</span> <span class="pre">'gamma':</span> <span class="pre">2.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/losses_func.html#weak_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.losses_func.weak_cross_entropy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.losses_func.size_constraint_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.losses_func.</span></span><span class="sig-name descname"><span class="pre">size_constraint_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/losses_func.html#size_constraint_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.losses_func.size_constraint_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.losses_func.weak_bce_sigmoid_loss">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.losses_func.</span></span><span class="sig-name descname"><span class="pre">weak_bce_sigmoid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/losses_func.html#weak_bce_sigmoid_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.losses_func.weak_bce_sigmoid_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.losses_func.bbox_overlaps">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.losses_func.</span></span><span class="sig-name descname"><span class="pre">bbox_overlaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bboxes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bboxes2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iou'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_aligned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/losses_func.html#bbox_overlaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.losses_func.bbox_overlaps" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Calculate overlap between two set of bboxes.</p>
<p class="linemarker linemarker-3">If <code class="docutils literal notranslate"><span class="pre">is_aligned</span> <span class="pre">``</span> <span class="pre">is</span> <span class="pre">``False</span></code>, then calculate the overlaps between each
bbox of bboxes1 and bboxes2, otherwise the overlaps between each aligned
pair of bboxes1 and bboxes2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bboxes1</strong> (<em>Tensor</em>) – shape (B, m, 4) in &lt;x1, y1, x2, y2&gt; format or empty.</p></li>
<li><p><strong>bboxes2</strong> (<em>Tensor</em>) – shape (B, n, 4) in &lt;x1, y1, x2, y2&gt; format or empty.
B indicates the batch dim, in shape (B1, B2, …, Bn).
If <code class="docutils literal notranslate"><span class="pre">is_aligned</span> <span class="pre">``</span> <span class="pre">is</span> <span class="pre">``True</span></code>, then m and n must be equal.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – “iou” (intersection over union), “iof” (intersection over
foreground) or “giou” (generalized intersection over union).
Default “iou”.</p></li>
<li><p><strong>is_aligned</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then m and n must be equal.
Default False.</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em>) – A value added to the denominator for numerical
stability. Default 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>shape (m, n) if <a href="#id1"><span class="problematic" id="id2">``</span></a>is_aligned `` is False else shape (m,)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bboxes1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">42</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bboxes2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">overlaps</span> <span class="o">=</span> <span class="n">bbox_overlaps</span><span class="p">(</span><span class="n">bboxes1</span><span class="p">,</span> <span class="n">bboxes2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">overlaps</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">overlaps</span> <span class="o">=</span> <span class="n">bbox_overlaps</span><span class="p">(</span><span class="n">bboxes1</span><span class="p">,</span> <span class="n">bboxes2</span><span class="p">,</span> <span class="n">is_aligned</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">overlaps</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">empty</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonempty</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">bbox_overlaps</span><span class="p">(</span><span class="n">empty</span><span class="p">,</span> <span class="n">nonempty</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">bbox_overlaps</span><span class="p">(</span><span class="n">nonempty</span><span class="p">,</span> <span class="n">empty</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">bbox_overlaps</span><span class="p">(</span><span class="n">empty</span><span class="p">,</span> <span class="n">empty</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-horizonms.losses.parallel_transform">
<span id="horizonms-losses-parallel-transform"></span><h2>horizonms.losses.parallel_transform<a class="headerlink" href="#module-horizonms.losses.parallel_transform" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.parallel_transform.rotate">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.parallel_transform.</span></span><span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/horizonms/losses/parallel_transform.html#rotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.parallel_transform.rotate" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Rotate the image by angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>Tensor</em>) – image to be rotated.</p></li>
<li><p><strong>angle</strong> (<em>float</em><em> or </em><em>int</em>) – rotation angle value in degrees, counter-clockwise.</p></li>
<li><p><strong>resample</strong> (<em>optional</em>) – An optional resampling filter. If omitted, or if the image has mode “1” or “P”, it is set to <code class="docutils literal notranslate"><span class="pre">NEAREST</span></code>.</p></li>
<li><p><strong>expand</strong> (<em>bool</em><em>, </em><em>optional</em>) – Optional expansion flag.
If true, expands the output image to make it large enough to hold the entire rotated image.
If false or omitted, make the output image the same size as the input image.
Note that the expand flag assumes rotation around the center and no translation.</p></li>
<li><p><strong>center</strong> (<em>list</em><em> or </em><em>tuple</em><em>, </em><em>optional</em>) – Optional center of rotation. Origin is the upper left corner.
Default is the center of the image.</p></li>
<li><p><strong>fill</strong> (<em>n-tuple</em><em> or </em><em>int</em><em> or </em><em>float</em>) – Pixel fill value for area outside the rotated
image. If int or float, the value is used for all bands respectively.
Defaults to 0 for all bands. This option is not supported for Tensor input.
Fill value for the area outside the transform in the output image is always 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rotated image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.parallel_transform.parallel_transform">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.parallel_transform.</span></span><span class="sig-name descname"><span class="pre">parallel_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/parallel_transform.html#parallel_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.parallel_transform.parallel_transform" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">parallel transformation defined in paper
Wang, J. and Xia, B., 2023. Weakly Supervised Image Segmentation Beyond Tight Bounding Box Annotations. arXiv preprint arXiv:2301.12053.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>Tensor</em>) – image data.</p></li>
<li><p><strong>box_height</strong> (<em>int</em>) – height of bounding box.</p></li>
<li><p><strong>box_width</strong> (<em>int</em>) – width of bounding box.</p></li>
<li><p><strong>angle</strong> (<em>float</em>) – angle of parallel transformation.</p></li>
<li><p><strong>is_mask</strong> (<em>bool</em>) – if True, box-mask image is considered.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for stability of calculation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-horizonms.losses.polar_transform">
<span id="horizonms-losses-polar-transform"></span><h2>horizonms.losses.polar_transform<a class="headerlink" href="#module-horizonms.losses.polar_transform" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="horizonms.losses.polar_transform.polar_transform">
<span class="sig-prename descclassname"><span class="pre">horizonms.losses.polar_transform.</span></span><span class="sig-name descname"><span class="pre">polar_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">360</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/polar_transform.html#polar_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.polar_transform.polar_transform" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">polar transformation defined in paper
Wang, J. and Xia, B., 2023. Weakly Supervised Image Segmentation Beyond Tight Bounding Box Annotations. arXiv preprint arXiv:2301.12053.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>Tensor</em>) – image data.</p></li>
<li><p><strong>center</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – center of polar transformation.</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – radius of polar transformation.</p></li>
<li><p><strong>output_shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – <cite>output_shape = (height, width)</cite>, dimension of output of polar transformation.</p></li>
<li><p><strong>height</strong> (<em>int</em>) – height of output of polar transformation.</p></li>
<li><p><strong>scaling</strong> (<em>str</em>) – rule of polar coordinate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-horizonms.losses.regression_losses">
<span id="horizonms-losses-regression-losses"></span><h2>horizonms.losses.regression_losses<a class="headerlink" href="#module-horizonms.losses.regression_losses" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.regression_losses.SmoothL1Loss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.regression_losses.</span></span><span class="sig-name descname"><span class="pre">SmoothL1Loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_average</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/regression_losses.html#SmoothL1Loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.regression_losses.SmoothL1Loss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="linemarker linemarker-1">Smooth L1 loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<em>float</em>) – the threshold at which to change between L1 and L2 loss. The value must be non-negative. Default: 3.0</p></li>
<li><p><strong>size_average</strong> (<em>bool</em>) – whether to average among samples.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.regression_losses.RegressionIouLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.regression_losses.</span></span><span class="sig-name descname"><span class="pre">RegressionIouLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/regression_losses.html#RegressionIouLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.regression_losses.RegressionIouLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="linemarker linemarker-1">Iou loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>str</em>) – specifies which iou loss is calculated. It can be <cite>‘iou’</cite>, <cite>‘iof’</cite>, or <cite>‘giou’</cite>.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of loss.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-horizonms.losses.sigmoid_losses">
<span id="horizonms-losses-sigmoid-losses"></span><h2>horizonms.losses.sigmoid_losses<a class="headerlink" href="#module-horizonms.losses.sigmoid_losses" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.sigmoid_losses.SigmoidCrossEntropyLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">SigmoidCrossEntropyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">argv</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/sigmoid_losses.html#SigmoidCrossEntropyLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.sigmoid_losses.SigmoidCrossEntropyLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <a class="reference internal" href="#horizonms.losses.base.SigmoidBaseLoss" title="horizonms.losses.base.SigmoidBaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigmoidBaseLoss</span></code></a></p>
<p class="linemarker linemarker-1">Cross entropy loss for sigmoid output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em>) – the mode of cross entropy loss. It is ‘all’ or ‘balance’. Default: <code class="docutils literal notranslate"><span class="pre">'all'</span></code>.
These two modes are different in how to get focal loss from individual samples.
‘all’ returns an average for all samples.
‘balance’ returns an average for all class, each class also returns an average for all of its samples.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.sigmoid_losses.SigmoidCrossEntropyLoss.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/sigmoid_losses.html#SigmoidCrossEntropyLoss.calculate_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.sigmoid_losses.SigmoidCrossEntropyLoss.calculate_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.sigmoid_losses.SigmoidFocalLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.sigmoid_losses.</span></span><span class="sig-name descname"><span class="pre">SigmoidFocalLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">argv</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/sigmoid_losses.html#SigmoidFocalLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.sigmoid_losses.SigmoidFocalLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <a class="reference internal" href="#horizonms.losses.base.SigmoidBaseLoss" title="horizonms.losses.base.SigmoidBaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigmoidBaseLoss</span></code></a></p>
<p class="linemarker linemarker-1">Focal loss for sigmoid output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>float</em>) – Weighting factor in range (0,1) to balance positive vs negative examples or -1 for ignore. Default: <code class="docutils literal notranslate"><span class="pre">0.25</span></code>.</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – Exponent of the modulating factor to balance easy vs hard examples. Default: <code class="docutils literal notranslate"><span class="pre">2.0</span></code>.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – the threshold to determine positive and negative classes in ground truth. Default: <code class="docutils literal notranslate"><span class="pre">0.5</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.sigmoid_losses.SigmoidFocalLoss.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/sigmoid_losses.html#SigmoidFocalLoss.calculate_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.sigmoid_losses.SigmoidFocalLoss.calculate_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-horizonms.losses.sigmoid_softmax_losses">
<span id="horizonms-losses-sigmoid-softmax-losses"></span><h2>horizonms.losses.sigmoid_softmax_losses<a class="headerlink" href="#module-horizonms.losses.sigmoid_softmax_losses" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.sigmoid_softmax_losses.DiceLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.sigmoid_softmax_losses.</span></span><span class="sig-name descname"><span class="pre">DiceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/sigmoid_softmax_losses.html#DiceLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.sigmoid_softmax_losses.DiceLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="linemarker linemarker-1">Dice loss for network output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>epsilon</strong> (<em>float</em>) – a small number for the stability of loss.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-horizonms.losses.softmax_losses">
<span id="horizonms-losses-softmax-losses"></span><h2>horizonms.losses.softmax_losses<a class="headerlink" href="#module-horizonms.losses.softmax_losses" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.softmax_losses.SoftmaxCohenKappaLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.softmax_losses.</span></span><span class="sig-name descname"><span class="pre">SoftmaxCohenKappaLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'quadratic'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">argv</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/softmax_losses.html#SoftmaxCohenKappaLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.softmax_losses.SoftmaxCohenKappaLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <a class="reference internal" href="#horizonms.losses.base.SoftmaxBaseLoss" title="horizonms.losses.base.SoftmaxBaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">SoftmaxBaseLoss</span></code></a></p>
<p class="linemarker linemarker-1">Cohen’s kappa loss for softmax output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>weights</strong> (<em>str</em>) – the type of Cohen’s kappa.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.softmax_losses.SoftmaxCohenKappaLoss.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/softmax_losses.html#SoftmaxCohenKappaLoss.calculate_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.softmax_losses.SoftmaxCohenKappaLoss.calculate_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.softmax_losses.SoftmaxFocalLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.softmax_losses.</span></span><span class="sig-name descname"><span class="pre">SoftmaxFocalLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">argv</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/softmax_losses.html#SoftmaxFocalLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.softmax_losses.SoftmaxFocalLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <a class="reference internal" href="#horizonms.losses.base.SoftmaxBaseLoss" title="horizonms.losses.base.SoftmaxBaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">SoftmaxBaseLoss</span></code></a></p>
<p class="linemarker linemarker-1">Focal loss for softmax output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>str</em>) – the mode of focal loss. It is ‘all’ or ‘foreground’. Default: <code class="docutils literal notranslate"><span class="pre">'all'</span></code>.
These two modes are different in how to get focal loss from individual samples.
‘all’ uses the average loss of all samples.
‘foreground’ is similar as the original focal loss which only considers the foreground in the denominator.</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – Exponent of the modulating factor to balance easy vs hard examples. Default: <code class="docutils literal notranslate"><span class="pre">2.0</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.softmax_losses.SoftmaxFocalLoss.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/softmax_losses.html#SoftmaxFocalLoss.calculate_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.softmax_losses.SoftmaxFocalLoss.calculate_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.softmax_losses.SoftmaxMixFocalLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.softmax_losses.</span></span><span class="sig-name descname"><span class="pre">SoftmaxMixFocalLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">argv</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/softmax_losses.html#SoftmaxMixFocalLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.softmax_losses.SoftmaxMixFocalLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <a class="reference internal" href="#horizonms.losses.base.SoftmaxBaseLoss" title="horizonms.losses.base.SoftmaxBaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">SoftmaxBaseLoss</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.softmax_losses.SoftmaxMixFocalLoss.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/softmax_losses.html#SoftmaxMixFocalLoss.calculate_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.softmax_losses.SoftmaxMixFocalLoss.calculate_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="horizonms.losses.softmax_losses.SoftmaxCrossEntropyLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">horizonms.losses.softmax_losses.</span></span><span class="sig-name descname"><span class="pre">SoftmaxCrossEntropyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">argv</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/softmax_losses.html#SoftmaxCrossEntropyLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.softmax_losses.SoftmaxCrossEntropyLoss" title="Link to this definition"></a></dt>
<dd><p class="linemarker linemarker-1">Bases: <a class="reference internal" href="#horizonms.losses.base.SoftmaxBaseLoss" title="horizonms.losses.base.SoftmaxBaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">SoftmaxBaseLoss</span></code></a></p>
<p class="linemarker linemarker-1">Cross entropy loss for softmax output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em>) – the mode of cross entropy loss. It is ‘all’ or ‘balance’. Default: <code class="docutils literal notranslate"><span class="pre">'all'</span></code>.
These two modes are different in how to get focal loss from individual samples.
‘all’ returns an average for all samples.
‘balance’ returns an average for each class.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="horizonms.losses.softmax_losses.SoftmaxCrossEntropyLoss.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/horizonms/losses/softmax_losses.html#SoftmaxCrossEntropyLoss.calculate_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#horizonms.losses.softmax_losses.SoftmaxCrossEntropyLoss.calculate_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="horizonms.engine.html" class="btn btn-neutral float-left" title="horizonms.engine" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="horizonms.metrics.html" class="btn btn-neutral float-right" title="horizonms.metrics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Medical Imaging Technology Lab @ Sibionics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>